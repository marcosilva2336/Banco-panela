<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histórico de Transferências</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/controledegastos.css" />

</head>

<body>
    <div class="navbar">
        <div class="user-info">
          <span class="user-name">Bem-Vindo, Marcos</span>
        </div>
      </div>
    <button id="hamburger-btn">&#9776;</button>

    <div id="sidebar">
        <img src="/img/logo.png" alt="Logo">
        <ul class="list-unstyled">
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-moon-fill me-2"></i>
                    Modo Escuro
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3 active">
                    <i class="bi bi-bar-chart-fill me-2"></i>
                    Controle de Gastos
                </a>
            </li>
            
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-credit-card-fill me-2"></i>
                    Cartões
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-shield-lock-fill me-2"></i>
                    Seguro
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-arrow-left-right me-2"></i>
                    Transferências
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-person-fill me-2"></i>
                    Meus Dados
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-file-earmark-text me-2"></i>
                    Extratos
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-cash-stack me-2"></i>
                    Investimentos
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-gear-fill me-2"></i>
                    Configurações
                </a>
            </li>
            <li class="mb-2">
                <a href="#" class="nav-link px-3">
                    <i class="bi bi-box-arrow-in-right me-2"></i>
                    Logout
                </a>
            </li>
        </ul>
    </div>
    <div class="container">
        <div class="card-info">
            <div id="received">
                <h2>Recebido</h2>
                <p>R$ 0,00</p>
            </div>
            <div id="transferred">
                <h2>Transferido</h2>
                <p>R$ 0,00</p>
            </div>
            <div id="saldo">
                <h2>Saldo</h2>
                <p>R$ 0,00</p>
            </div>
        </div>

        <div class="card-body">
            <h2>Transações</h2>
            <button type="button" style="border: black  1px dashed; color: #000;" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#transactionModal">
                Adicionar Transação
            </button>
            <table>
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Tipo</th>
                        <th>Transferência</th>
                        <th>Banco</th>
                        <th>Valor</th>
                        <th>Detalhes</th>
                        <th>Excluir</th>
                    </tr>
                </thead>
                <tbody id="transaction-history">
                </tbody>
            </table>
        </div>

    </div>


    <!-- O Modal -->
    <div class="modal fade" id="transactionModal" tabindex="-1" aria-labelledby="transactionModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Cabeçalho do Modal -->
                <div class="modal-header">
                    <h5 class="modal-title" id="transactionModalLabel">Nova Transação</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <!-- Corpo do Modal -->
                <div class="modal-body">
                    <!-- Aqui o formulário de transação -->
                    <form id="transaction-form">
                        <div class="mb-3">
                            <label for="date" class="form-label">Data:</label>
                            <input type="date" class="form-control" id="date" name="date" required>
                        </div>
                        <div class="mb-3">
                            <label for="type" class="form-label">Tipo:</label>
                            <select id="type" name="type" class="form-select" required>
                                <option value="recebido">Recebido</option>
                                <option value="transferido">Transferido</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="transferType" class="form-label">Transferência:</label>
                            <input type="text" class="form-control" id="transferType" name="transferType" required>
                        </div>
                        <div class="mb-3">
                            <label for="bank" class="form-label">Banco:</label>
                            <input type="text" class="form-control" id="bank" name="bank" required>
                        </div>
                        <div class="mb-3">
                            <label for="destination" class="form-label">Destino:</label>
                            <input type="text" class="form-control" id="destination" name="destination" required>
                        </div>
                        <div class="mb-3">
                            <label for="value" class="form-label">Valor:</label>
                            <input type="number" class="form-control" id="value" name="value" step="0.01" min="0"
                                required>
                        </div>
                    </form>

                </div>
                <!-- Rodapé do Modal -->
                <div class="modal-footer">
                    <button type="submit" form="transaction-form" class="btn btn-primary">Adicionar</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let transactions = [
            { id: 1, date: '2023-07-01', type: 'recebido', transferType: 'PIX', bank: 'Banco do Brasil', destination: 'Conta pessoal', value: 5000.00 },
            { id: 2, date: '2023-07-05', type: 'transferido', transferType: 'TED', bank: 'Itaú', destination: 'Conta corretora', value: 1500.00 },
            { id: 3, date: '2023-07-10', type: 'recebido', transferType: 'DOC', bank: 'Bradesco', destination: 'Conta salário', value: 3000.00 },
            { id: 4, date: '2023-07-15', type: 'transferido', transferType: 'PIX', bank: 'Santander', destination: 'Conta poupança', value: 2000.00 },
            { id: 5, date: '2023-07-15', type: 'transferido', transferType: 'PIX', bank: 'Santander', destination: 'Conta poupança', value: 2000.00 },
            { id: 6, date: '2023-07-15', type: 'transferido', transferType: 'PIX', bank: 'Santander', destination: 'Conta poupança', value: 2000.00 }
        ];

        let received = 0;
        let transferred = 0;

        const transactionHistory = document.getElementById('transaction-history');

        const form = document.getElementById('transaction-form');
        form.addEventListener('submit', function (event) {
            event.preventDefault();

            const date = form.elements.date.value;
            const type = form.elements.type.value;
            const transferType = form.elements.transferType.value;
            const bank = form.elements.bank.value;
            const destination = form.elements.destination.value;
            const value = parseFloat(form.elements.value.value);
            const id = transactions.length + 1;

            transactions.push({ id: id, date: date, type: type, transferType: transferType, bank: bank, destination: destination, value: value });
            form.reset();

            updateTable();
        });

        function updateTable() {
            received = 0;
            transferred = 0;

            const saldoElement = document.getElementById('saldo').lastElementChild;

            transactionHistory.innerHTML = '';

            transactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.innerHTML = `
        <td>${transaction.date}</td>
        <td>${transaction.type}</td>
        <td>${transaction.transferType}</td>
        <td>${transaction.bank}</td>
        <td>R$ ${transaction.value.toFixed(2)}</td>
        <td class="text-center"><button class="btn btn-info btn-sm" onclick="toggleDetails(${transaction.id})"><i class="bi bi-info-circle-fill"></i></button></td>
        <td class="text-center"><button class="btn btn-danger btn-sm" onclick="deleteTransaction(${transaction.id})"><i class="bi bi-trash-fill"></i></button></td>
    `;
                transactionHistory.appendChild(row);


                if (transaction.type === 'recebido') {
                    received += transaction.value;
                } else {
                    transferred += transaction.value;
                }

                const detailsRow = document.createElement('tr');
                detailsRow.setAttribute('id', `details-row-${transaction.id}`);
                detailsRow.style.display = 'none';
                detailsRow.innerHTML = `
                    <td colspan="6">
                        <strong>Data:</strong> ${transaction.date}<br>
                        <strong>Tipo:</strong> ${transaction.type}<br>
                        <strong>Transferência:</strong> ${transaction.transferType}<br>
                        <strong>Banco:</strong> ${transaction.bank}<br>
                        <strong>Destino:</strong> ${transaction.destination}<br>
                        <strong>Valor:</strong> R$ ${transaction.value.toFixed(2)}
                    </td>
                `;
                transactionHistory.appendChild(detailsRow);
            });

            saldoElement.textContent = `R$ ${(received - transferred).toFixed(2)}`;

            if (received - transferred < 0) {
                saldoElement.style.color = 'red';
            } else {
                saldoElement.style.color = '';
            }

            document.getElementById('received').lastElementChild.textContent = `R$ ${received.toFixed(2)}`;
            document.getElementById('transferred').lastElementChild.textContent = `R$ ${transferred.toFixed(2)}`;
        }

        function toggleDetails(id) {
            const detailsRow = document.getElementById(`details-row-${id}`);
            if (detailsRow.style.display === 'none') {
                detailsRow.style.display = 'table-row';
            } else {
                detailsRow.style.display = 'none';
            }
        }

        function deleteTransaction(id) {
            transactions = transactions.filter(transaction => transaction.id !== id);
            updateTable();
        }

        updateTable();
    </script>
</body>

</html>